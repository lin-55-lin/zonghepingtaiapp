<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>ç»¼åˆå¹³å° Â· å…±äº«ç‰ˆ</title>
    <link rel="stylesheet" href="./style.css">
    <style>
        /* æ·»åŠ ä¸€äº›æç¤ºæ ·å¼ */
        .sync-status {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 20px;
            border-radius: 30px;
            background: #2ea44f;
            color: white;
            font-size: 14px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            display: none;
            z-index: 9999;
        }
        .sync-status.show {
            display: block;
        }
        .version-tag {
            font-size: 12px;
            color: #666;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1 id="app-title">
                ç»¼åˆå¹³å°
                <span class="version-tag" id="versionDisplay">V1.1.0</span>
            </h1>
        </header>
        
        <div class="search-bar">
            <input type="text" id="search-input" placeholder="æœç´¢AIè½¯ä»¶...">
            <button id="search-btn" class="search-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
            </button>
            <button id="manage-mode-btn" class="manage-mode-btn">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                </svg>
            </button>
            <button id="toggle-cards-btn" class="toggle-cards-btn">
                <svg width="8" height="8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                </svg>
            </button>
        </div>
        
        <!-- ç®¡ç†åŠŸèƒ½é¢æ¿ -->
        <div id="manage-panel" class="manage-panel" style="display: none;">
            <div class="manage-buttons">
                <button id="import-btn" class="import-btn">å¯¼å…¥</button>
                <button id="export-btn" class="export-btn">å¯¼å‡º</button>
                <button id="batch-delete-btn" class="batch-delete-btn">åˆ é™¤</button>
                <button id="select-all-btn" class="select-all-btn">å…¨é€‰</button>
                <button id="wallpaper-btn" class="wallpaper-btn">å£çº¸</button>
                <button id="layout-btn" class="layout-btn">å¸ƒå±€</button>
                <button id="sync-btn" class="import-btn">ğŸ”„ åŒæ­¥</button>
            </div>
        </div>
        
        <!-- æ·»åŠ å¡ç‰‡è¡¨å• -->
        <div id="add-card-form" class="add-card-form" style="display: none;">
            <h3>æ·»åŠ æ–°è½¯ä»¶å¡ç‰‡</h3>
            <form id="new-card-form">
                <div class="form-group">
                    <label for="card-name">è½¯ä»¶åç§°:</label>
                    <input type="text" id="card-name" required>
                </div>
                <div class="form-group">
                    <label for="card-website">ç½‘å€é“¾æ¥:</label>
                    <input type="url" id="card-website" required>
                </div>
                <div class="form-group">
                    <label for="card-category">åˆ†ç±»:</label>
                    <select id="card-category" required>
                        <option value="">è¯·é€‰æ‹©åˆ†ç±»</option>
                        <option value="text">æ–‡æœ¬å¤„ç†</option>
                        <option value="image">å›¾åƒç”Ÿæˆ</option>
                        <option value="voice">è¯­éŸ³è¯†åˆ«</option>
                        <option value="office">åŠå…¬è½¯ä»¶</option>
                        <option value="custom">è‡ªå®šä¹‰åˆ†ç±»</option>
                    </select>
                </div>
                <div class="form-group" id="custom-category-group" style="display: none;">
                    <label for="custom-category">è‡ªå®šä¹‰åˆ†ç±»åç§°:</label>
                    <input type="text" id="custom-category" placeholder="è¯·è¾“å…¥è‡ªå®šä¹‰åˆ†ç±»åç§°">
                </div>
                <div class="form-buttons">
                    <button type="submit" class="submit-btn">æ·»åŠ å¡ç‰‡</button>
                    <button type="button" id="cancel-btn" class="cancel-btn">å–æ¶ˆ</button>
                </div>
            </form>
        </div>
        
        <div class="category-tabs" id="category-tabs">
            <button class="tab-btn active" data-category="all">å…¨éƒ¨</button>
            <button class="tab-btn" data-category="text">æ–‡æœ¬å¤„ç†</button>
        </div>
        
        <div class="ai-cards-container" id="ai-cards">
            <!-- AIè½¯ä»¶å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
        </div>
        <button id="add-card-btn" class="add-card-btn">+</button>
    </div>
    
    <!-- å£çº¸è®¾ç½®å¼¹çª— -->
    <div id="wallpaper-modal" class="wallpaper-modal" style="display: none;">
        <div class="wallpaper-modal-content">
            <div class="wallpaper-modal-header">
                <h3>å£çº¸è®¾ç½®</h3>
                <button id="close-wallpaper-modal" class="close-wallpaper-modal">Ã—</button>
            </div>
            <div class="wallpaper-modal-body">
                <!-- å½“å‰å£çº¸é¢„è§ˆ -->
                <div class="current-wallpaper" style="margin-bottom: 20px; text-align: center;">
                    <div id="current-wallpaper-preview" style="width: 100%; height: 100px; border-radius: 8px; background-size: cover; background-position: center; border: 2px solid #ddd;"></div>
                    <p style="margin: 10px 0 0; color: #666;">å½“å‰å£çº¸</p>
                </div>
                
                <div class="wallpaper-options">
                    <!-- ä¸Šä¼ æ–°å£çº¸ - å¯æŠ˜å  -->
                    <div class="wallpaper-option">
                        <h4 onclick="toggleWallpaperSection('upload')" style="cursor: pointer; display: flex; justify-content: space-between; align-items: center;">
                            ğŸ“¤ ä¸Šä¼ æ–°å£çº¸
                            <span id="upload-icon">â–¼</span>
                        </h4>
                        <div id="upload-section" class="upload-area" style="border: 2px dashed #ccc; padding: 20px; text-align: center; border-radius: 8px; margin-top: 10px; display: none;" onclick="document.getElementById('wallpaper-upload').click()">
                            <p>ç‚¹å‡»é€‰æ‹©å›¾ç‰‡æˆ–æ‹–æ‹½åˆ°è¿™é‡Œ</p>
                            <p style="font-size: 12px; color: #999;">æ”¯æŒ JPGã€PNGã€GIF</p>
                            <input type="file" id="wallpaper-upload" accept="image/*" style="display: none;">
                        </div>
                    </div>
                    
                    <!-- çº¯è‰²å£çº¸ - å¯æŠ˜å  -->
                    <div class="wallpaper-option" style="margin-top: 10px;">
                        <h4 onclick="toggleWallpaperSection('color')" style="cursor: pointer; display: flex; justify-content: space-between; align-items: center;">
                            ğŸ¨ çº¯è‰²å£çº¸
                            <span id="color-icon">â–¼</span>
                        </h4>
                        <div id="color-section" class="color-grid" style="display: none; grid-template-columns: repeat(6, 1fr); gap: 8px; margin-top: 10px;">
                            <div class="color-option" data-color="#ffffff" style="background-color: #ffffff; width: 100%; aspect-ratio: 1; border-radius: 4px; cursor: pointer; border: 2px solid transparent;"></div>
                            <div class="color-option" data-color="#f0f0f0" style="background-color: #f0f0f0;"></div>
                            <div class="color-option" data-color="#e0e0e0" style="background-color: #e0e0e0;"></div>
                            <div class="color-option" data-color="#d0d0d0" style="background-color: #d0d0d0;"></div>
                            <div class="color-option" data-color="#c0c0c0" style="background-color: #c0c0c0;"></div>
                            <div class="color-option" data-color="#a0a0a0" style="background-color: #a0a0a0;"></div>
                            <div class="color-option" data-color="#808080" style="background-color: #808080;"></div>
                            <div class="color-option" data-color="#606060" style="background-color: #606060;"></div>
                            <div class="color-option" data-color="#404040" style="background-color: #404040;"></div>
                            <div class="color-option" data-color="#202020" style="background-color: #202020;"></div>
                            <div class="color-option" data-color="#000000" style="background-color: #000000;"></div>
                            <div class="color-option" data-color="#ff6b6b" style="background-color: #ff6b6b;"></div>
                            <div class="color-option" data-color="#4ecdc4" style="background-color: #4ecdc4;"></div>
                            <div class="color-option" data-color="#45b7d1" style="background-color: #45b7d1;"></div>
                            <div class="color-option" data-color="#96ceb4" style="background-color: #96ceb4;"></div>
                            <div class="color-option" data-color="#feca57" style="background-color: #feca57;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- å¸ƒå±€è®¾ç½®å¼¹çª— -->
    <div id="layout-modal" class="layout-modal" style="display: none;">
        <div class="layout-modal-content">
            <div class="layout-modal-header">
                <h3>å¸ƒå±€</h3>
                <button id="close-layout-modal" class="close-layout-modal">Ã—</button>
            </div>
            <div class="layout-modal-body">
                <div class="quick-layouts">
                    <h4>å¿«æ·å¸ƒå±€</h4>
                    <div class="layout-buttons">
                        <button class="layout-btn-quick" data-layout="2x4">2Ã—4</button>
                        <button class="layout-btn-quick" data-layout="2x5">2Ã—5</button>
                        <button class="layout-btn-quick" data-layout="2x6">2Ã—6</button>
                        <button class="layout-btn-quick" data-layout="2x7">2Ã—7</button>
                        <button class="layout-btn-quick" data-layout="3x3">3Ã—3</button>
                        <button class="layout-btn-quick" data-layout="custom">è‡ªå®šä¹‰</button>
                    </div>
                </div>
                
                <div class="custom-layout" id="custom-layout" style="display: none;">
                    <h4>è‡ªå®šä¹‰è®¾ç½®</h4>
                    <div class="layout-option">
                        <label for="rows-input">è¡Œæ•° (1-8):</label>
                        <input type="number" id="rows-input" min="1" max="8" value="3">
                        <span class="value-display" id="rows-value">3</span>
                    </div>
                    
                    <div class="layout-option">
                        <label for="columns-input">åˆ—æ•° (1-10):</label>
                        <input type="number" id="columns-input" min="1" max="10" value="10">
                        <span class="value-display" id="columns-value">10</span>
                    </div>
                    
                    <div class="layout-option">
                        <label for="icon-size-slider">å›¾æ ‡å¤§å° (0-100%):</label>
                        <input type="range" id="icon-size-slider" min="0" max="100" value="100">
                        <span class="value-display" id="icon-size-value">100%</span>
                    </div>
                    
                    <div class="layout-buttons">
                        <button id="apply-layout" class="apply-layout">åº”ç”¨è®¾ç½®</button>
                        <button id="reset-layout" class="reset-layout">é‡ç½®é»˜è®¤</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- åŒæ­¥çŠ¶æ€æç¤º -->
    <div id="syncStatus" class="sync-status"></div>

    <script>
        // ============ é…ç½® ============
        const APP_VERSION = 'v1.1.0';
        const REPO_OWNER = 'lin-55-lin';        // ä½ çš„GitHubç”¨æˆ·å
        const REPO_NAME = 'zonghepingtaiapp';   // ä½ çš„ä»“åº“å
        // ==============================

        // æ˜¾ç¤ºç‰ˆæœ¬
        document.getElementById('versionDisplay').textContent = 'V' + APP_VERSION;

        // GitHub Token - ç›´æ¥å†™æ­»ï¼Œæ‰€æœ‰äººéƒ½ç”¨è¿™ä¸€ä¸ª
        const GITHUB_TOKEN = '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';

        // ============ æ•°æ®ç®¡ç† ============
        
        // æ˜¾ç¤ºåŒæ­¥çŠ¶æ€
        function showSyncStatus(message, isSuccess = true) {
            const status = document.getElementById('syncStatus');
            status.textContent = message;
            status.style.backgroundColor = isSuccess ? '#2ea44f' : '#dc3545';
            status.classList.add('show');
            setTimeout(() => {
                status.classList.remove('show');
            }, 3000);
        }

        // åŠ è½½æ‰€æœ‰æ•°æ®
        async function loadAllData() {
            try {
                showSyncStatus('æ­£åœ¨åŠ è½½æ•°æ®...', true);
                
                // è·å–æ‰€æœ‰Issues
                const response = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/issues?state=all&_t=${Date.now()}`);
                const issues = await response.json();
                
                // åˆ†ç¦»ä¸åŒç±»å‹çš„æ•°æ®
                const cards = issues.filter(i => i.title.startsWith('ã€å¡ç‰‡ã€‘'));
                const wallpaper = issues.find(i => i.title === 'ã€å£çº¸é…ç½®ã€‘');
                const layout = issues.find(i => i.title === 'ã€å¸ƒå±€é…ç½®ã€‘');
                
                // åº”ç”¨å£çº¸
                if (wallpaper) {
                    try {
                        const wallpaperData = JSON.parse(wallpaper.body);
                        if (wallpaperData.type === 'image') {
                            document.body.style.backgroundImage = `url(${wallpaperData.value})`;
                            document.body.style.backgroundSize = 'cover';
                            document.body.style.backgroundPosition = 'center';
                            document.body.style.backgroundRepeat = 'no-repeat';
                        } else {
                            document.body.style.backgroundImage = 'none';
                            document.body.style.backgroundColor = wallpaperData.value;
                        }
                    } catch (e) {
                        console.error('è§£æå£çº¸æ•°æ®å¤±è´¥:', e);
                    }
                }
                
                // åº”ç”¨å¸ƒå±€
                if (layout) {
                    try {
                        const layoutData = JSON.parse(layout.body);
                        applyLayoutSettings(layoutData);
                    } catch (e) {
                        console.error('è§£æå¸ƒå±€æ•°æ®å¤±è´¥:', e);
                    }
                }
                
                // å°†å¡ç‰‡æ•°æ®è½¬æ¢ä¸ºå…¨å±€å˜é‡æ ¼å¼
                window.cards = cards.map(issue => {
                    const parts = issue.body.split('|');
                    return {
                        id: issue.number,
                        name: parts[0] || '',
                        website: parts[1] || '',
                        category: parts[2] || 'å…¶ä»–',
                    };
                });
                
                // è§¦å‘å¡ç‰‡æ›´æ–°äº‹ä»¶
                document.dispatchEvent(new CustomEvent('cardsUpdated', { detail: window.cards }));
                
                showSyncStatus('åŠ è½½å®Œæˆ', true);
            } catch (error) {
                showSyncStatus('åŠ è½½å¤±è´¥: ' + error.message, false);
            }
        }

        // åº”ç”¨å¸ƒå±€è®¾ç½®
        function applyLayoutSettings(settings) {
            const container = document.getElementById('ai-cards');
            if (container && settings.columns) {
                container.style.gridTemplateColumns = `repeat(${settings.columns}, 1fr)`;
            }
        }

        // ä¿å­˜å¡ç‰‡
        async function saveCard(name, url, category) {
            try {
                const response = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/issues`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `token ${GITHUB_TOKEN}`,
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        title: `ã€å¡ç‰‡ã€‘${name}`,
                        body: `${name}|${url}|${category}|`
                    })
                });
                
                if (response.ok) {
                    showSyncStatus('å¡ç‰‡æ·»åŠ æˆåŠŸï¼', true);
                    return true;
                } else {
                    const err = await response.json();
                    showSyncStatus('ä¿å­˜å¤±è´¥: ' + err.message, false);
                    return false;
                }
            } catch (error) {
                showSyncStatus('ç½‘ç»œé”™è¯¯', false);
                return false;
            }
        }

        // æ›´æ–°å¡ç‰‡
        async function updateCard(cardId, name, url, category) {
            try {
                const response = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/issues/${cardId}`, {
                    method: 'PATCH',
                    headers: {
                        'Authorization': `token ${GITHUB_TOKEN}`,
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        title: `ã€å¡ç‰‡ã€‘${name}`,
                        body: `${name}|${url}|${category}|`
                    })
                });
                
                if (response.ok) {
                    showSyncStatus('å¡ç‰‡æ›´æ–°æˆåŠŸï¼', true);
                    return true;
                } else {
                    const err = await response.json();
                    showSyncStatus('æ›´æ–°å¤±è´¥: ' + err.message, false);
                    return false;
                }
            } catch (error) {
                showSyncStatus('ç½‘ç»œé”™è¯¯', false);
                return false;
            }
        }

        // åˆ é™¤å¡ç‰‡
        async function deleteCardById(issueNumber) {
            try {
                const response = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/issues/${issueNumber}`, {
                    method: 'PATCH',
                    headers: {
                        'Authorization': `token ${GITHUB_TOKEN}`,
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        state: 'closed'
                    })
                });
                
                if (response.ok) {
                    showSyncStatus('åˆ é™¤æˆåŠŸ', true);
                    return true;
                }
            } catch (error) {
                showSyncStatus('åˆ é™¤å¤±è´¥', false);
                return false;
            }
        }

        // ä¿å­˜å£çº¸åˆ°GitHub
        async function saveWallpaperToGitHub(wallpaperData) {
            try {
                const searchResponse = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/issues?state=all&_t=${Date.now()}`);
                const issues = await searchResponse.json();
                const existing = issues.find(i => i.title === 'ã€å£çº¸é…ç½®ã€‘');
                
                const dataToSave = JSON.stringify(wallpaperData);
                
                let response;
                if (existing) {
                    response = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/issues/${existing.number}`, {
                        method: 'PATCH',
                        headers: {
                            'Authorization': `token ${GITHUB_TOKEN}`,
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            body: dataToSave
                        })
                    });
                } else {
                    response = await fetch(`https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/issues`, {
                        method: 'POST',
                        headers: {
                            'Authorization': `token ${GITHUB_TOKEN}`,
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            title: 'ã€å£çº¸é…ç½®ã€‘',
                            body: dataToSave
                        })
                    });
                }
                
                if (response.ok) {
                    return true;
                } else {
                    const err = await response.json();
                    showSyncStatus('ä¿å­˜å¤±è´¥: ' + err.message, false);
                    return false;
                }
            } catch (error) {
                showSyncStatus('ç½‘ç»œé”™è¯¯', false);
                return false;
            }
        }

        // åˆ‡æ¢å£çº¸æŠ˜å éƒ¨åˆ†
        function toggleWallpaperSection(section) {
            const uploadSection = document.getElementById('upload-section');
            const colorSection = document.getElementById('color-section');
            const uploadIcon = document.getElementById('upload-icon');
            const colorIcon = document.getElementById('color-icon');
            
            if (section === 'upload') {
                if (uploadSection.style.display === 'none') {
                    uploadSection.style.display = 'block';
                    colorSection.style.display = 'none';
                    uploadIcon.textContent = 'â–²';
                    colorIcon.textContent = 'â–¼';
                } else {
                    uploadSection.style.display = 'none';
                    uploadIcon.textContent = 'â–¼';
                }
            } else {
                if (colorSection.style.display === 'none') {
                    colorSection.style.display = 'grid';
                    uploadSection.style.display = 'none';
                    colorIcon.textContent = 'â–²';
                    uploadIcon.textContent = 'â–¼';
                } else {
                    colorSection.style.display = 'none';
                    colorIcon.textContent = 'â–¼';
                }
            }
        }

        // å¼ºåˆ¶åˆ·æ–°
        async function forceRefresh() {
            await loadAllData();
        }

        // ============ äº‹ä»¶ç»‘å®š ============

        // é¡µé¢åŠ è½½
        window.onload = function() {
            loadAllData();
            
            // ç»‘å®šæ·»åŠ å¡ç‰‡æŒ‰é’®
            document.getElementById('add-card-btn').addEventListener('click', function() {
                document.getElementById('add-card-form').style.display = 'block';
            });
            
            // ç»‘å®šå–æ¶ˆæŒ‰é’®
            document.getElementById('cancel-btn').addEventListener('click', function() {
                document.getElementById('add-card-form').style.display = 'none';
            });
            
            // ç»‘å®šè¡¨å•æäº¤
            document.getElementById('new-card-form').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const name = document.getElementById('card-name').value;
                const url = document.getElementById('card-website').value;
                const category = document.getElementById('card-category').value;
                const customCategory = document.getElementById('custom-category').value;
                
                let finalCategory = category;
                if (category === 'custom') {
                    if (!customCategory) {
                        alert('è¯·å¡«å†™è‡ªå®šä¹‰åˆ†ç±»åç§°ï¼');
                        return;
                    }
                    finalCategory = customCategory;
                }
                
                if (await saveCard(name, url, finalCategory)) {
                    document.getElementById('add-card-form').style.display = 'none';
                    this.reset();
                    document.getElementById('custom-category-group').style.display = 'none';
                    loadAllData();
                }
            });
            
            // ç»‘å®šåˆ†ç±»é€‰æ‹©
            document.getElementById('card-category').addEventListener('change', function() {
                const customGroup = document.getElementById('custom-category-group');
                customGroup.style.display = this.value === 'custom' ? 'block' : 'none';
            });
            
            // ç»‘å®šå£çº¸æŒ‰é’®
            document.getElementById('wallpaper-btn').addEventListener('click', function() {
                document.getElementById('wallpaper-modal').style.display = 'flex';
            });
            
            // å…³é—­å£çº¸å¼¹çª—
            document.getElementById('close-wallpaper-modal').addEventListener('click', function() {
                document.getElementById('wallpaper-modal').style.display = 'none';
            });
            
            // ç»‘å®šé¢œè‰²é€‰æ‹©
            document.querySelectorAll('.color-option').forEach(option => {
                option.addEventListener('click', async function() {
                    const color = this.dataset.color;
                    const success = await saveWallpaperToGitHub({
                        type: 'solid',
                        value: color
                    });
                    
                    if (success) {
                        document.body.style.backgroundImage = 'none';
                        document.body.style.backgroundColor = color;
                        document.getElementById('wallpaper-modal').style.display = 'none';
                        showSyncStatus('å£çº¸å·²æ›´æ–°', true);
                    }
                });
            });
            
            // ç»‘å®šåŒæ­¥æŒ‰é’®
            document.getElementById('sync-btn').addEventListener('click', forceRefresh);
            
            // ç»‘å®šå¸ƒå±€æŒ‰é’®
            document.getElementById('layout-btn').addEventListener('click', function() {
                document.getElementById('layout-modal').style.display = 'flex';
            });
            
            // å…³é—­å¸ƒå±€å¼¹çª—
            document.getElementById('close-layout-modal').addEventListener('click', function() {
                document.getElementById('layout-modal').style.display = 'none';
            });
            
            // ç‚¹å‡»å¼¹çª—å¤–éƒ¨å…³é—­
            window.addEventListener('click', function(e) {
                if (e.target.classList.contains('wallpaper-modal')) {
                    document.getElementById('wallpaper-modal').style.display = 'none';
                }
                if (e.target.classList.contains('layout-modal')) {
                    document.getElementById('layout-modal').style.display = 'none';
                }
            });
        };
    </script>
    
    <!-- ä½ çš„åŸå§‹ script.js å†…å®¹ä¿æŒä¸å˜ï¼Œå¯ä»¥æ”¾åœ¨ä¸‹é¢ -->
    <script src="./script.js"></script>
</body>
</html>